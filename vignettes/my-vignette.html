<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>MultiHazard Vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">MultiHazard Vignette</h1>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;MultiHazard&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw">library</span>(<span class="st">&quot;scales&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;statmod&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;CDVine&quot;</span>)
<span class="co">#&gt; The CDVine package is no longer developed actively.</span>
<span class="co">#&gt; Please consider using the more general VineCopula package</span>
<span class="co">#&gt; (see https://CRAN.R-project.org/package=VineCopula),</span>
<span class="co">#&gt; which extends and improves the functionality of CDVine.</span></code></pre></div>
<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<p>The <code>MultiHazard</code> package provides tools for stationary multivariate statistical modeling such as of the joint distribution of MULTIple co-occurring HAZARDs. The package contains functions for pre-processing data including imputing missing values, detrending and declustering time series (Section 2) as well as analyzing pairwise correlations over a range of lags (Section 3). Functionality is also built in to conditionally sample a bivariate dataset (given one of the variables is above a predetermined threshold), selecting the best fitting amongst an array of parametric (extreme and non-extreme, truncated and non-truncated) marginal distributions or copulas, which allow the dependence structure between the set of variables to be modelled independenly of marginal distributions (Section 3). Estimation of joint probability contours using the method of overlaying (conditional) contours given in Bender et al. (2016) and subsequently for a given return period extracting design events assuming full dependence, as well as the “most likely” or an ensemble of possible design events once accounting for dependence is possible (Section 4). The package also provides the capability of fitting and simulating synthetic records from three higher dimensional approaches - standard (elliptic/Archimedean) copulas, Pair Copula Constructions (PCCs) and the conditional threshold exceedance approach of Heffernan and Tawn (2004) (Section 5).</p>
</div>
<div id="pre-processing" class="section level2">
<h2>2. Pre-processing</h2>
<div id="imputation" class="section level3">
<h3>Imputation</h3>
<p>Well G_3356 represents the groundwater level at Site S20, however, it contains missing values. Lets impute missing values in the record at Well G_3356 using recordings at nearby Well G_3355. Firstly, reading in the two time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Viewing first few rows of in the groundwater level records</span>
<span class="kw">head</span>(G_<span class="dv">3356</span>)
<span class="co">#&gt;         Date Value</span>
<span class="co">#&gt; 1 1985-10-23  2.46</span>
<span class="co">#&gt; 2 1985-10-24  2.47</span>
<span class="co">#&gt; 3 1985-10-25  2.41</span>
<span class="co">#&gt; 4 1985-10-26  2.37</span>
<span class="co">#&gt; 5 1985-10-27  2.63</span>
<span class="co">#&gt; 6 1985-10-28  2.54</span>
<span class="kw">head</span>(G_<span class="dv">3355</span>)
<span class="co">#&gt;         Date Value</span>
<span class="co">#&gt; 1 1985-08-20  2.53</span>
<span class="co">#&gt; 2 1985-08-21  2.50</span>
<span class="co">#&gt; 3 1985-08-22  2.46</span>
<span class="co">#&gt; 4 1985-08-23  2.43</span>
<span class="co">#&gt; 5 1985-08-24  2.40</span>
<span class="co">#&gt; 6 1985-08-25  2.37</span>
<span class="co">#Converting Date column to &quot;Date&quot;&quot; object</span>
G_<span class="dv">3356</span><span class="op">$</span>Date&lt;-<span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">&quot;1985-10-23&quot;</span>), <span class="kw">as.Date</span>(<span class="st">&quot;2019-05-29&quot;</span>), <span class="dt">by=</span><span class="st">&quot;day&quot;</span>)
G_<span class="dv">3355</span><span class="op">$</span>Date&lt;-<span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">&quot;1985-08-20&quot;</span>), <span class="kw">as.Date</span>(<span class="st">&quot;2019-06-02&quot;</span>), <span class="dt">by=</span><span class="st">&quot;day&quot;</span>)
<span class="co">#Converting column containing the readings to a &quot;numeric&quot;&quot; object</span>
G_<span class="dv">3356</span><span class="op">$</span>Value&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>(G_<span class="dv">3356</span><span class="op">$</span>Value))
G_<span class="dv">3355</span><span class="op">$</span>Value&lt;-<span class="kw">as.numeric</span>(<span class="kw">as.character</span>(G_<span class="dv">3355</span><span class="op">$</span>Value))</code></pre></div>
<p>Warning message confirms there are NAs in the record at Well G_3356. Before carrying out the imputation the two data frames need to be merged.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Merge the two dataframes by date</span>
GW_S20&lt;-<span class="kw">left_join</span>(G_<span class="dv">3356</span>,G_<span class="dv">3355</span>,<span class="dt">by=</span><span class="st">&quot;Date&quot;</span>)
<span class="kw">colnames</span>(GW_S20)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;G3356&quot;</span>,<span class="st">&quot;G3355&quot;</span>)
<span class="co">#Carrying out imputation</span>
Imp&lt;-<span class="kw">Imputation</span>(<span class="dt">Data=</span>GW_S20,<span class="dt">Variable=</span><span class="st">&quot;G3356&quot;</span>,<span class="dt">x_lab=</span><span class="st">&quot;G-3355 (ft NGVD 29)&quot;</span>, <span class="dt">y_lab=</span><span class="st">&quot;G-3356 (ft NGVD 29)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The completed record is given in the <code>ValuesFilled</code> column of the data frame outputted as the <code>Data</code> object while the linear regression model including its coefficient of determinant are given by the <code>model</code> output argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(Imp<span class="op">$</span>Data)
<span class="co">#&gt;         Date G3356 G3355 ValuesFilled</span>
<span class="co">#&gt; 1 1985-10-23  2.46  2.87         2.46</span>
<span class="co">#&gt; 2 1985-10-24  2.47  2.85         2.47</span>
<span class="co">#&gt; 3 1985-10-25  2.41  2.82         2.41</span>
<span class="co">#&gt; 4 1985-10-26  2.37  2.79         2.37</span>
<span class="co">#&gt; 5 1985-10-27  2.63  2.96         2.63</span>
<span class="co">#&gt; 6 1985-10-28  2.54  2.96         2.54</span>
Imp<span class="op">$</span>Model
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = data[, variable] ~ data[, Other.variable])</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -1.60190 -0.16654  0.00525  0.16858  1.73824 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)            0.275858   0.012366   22.31   &lt;2e-16 ***</span>
<span class="co">#&gt; data[, Other.variable] 0.700724   0.004459  157.15   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.2995 on 11825 degrees of freedom</span>
<span class="co">#&gt;   (445 observations deleted due to missingness)</span>
<span class="co">#&gt; Multiple R-squared:  0.6762, Adjusted R-squared:  0.6762 </span>
<span class="co">#&gt; F-statistic: 2.47e+04 on 1 and 11825 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
<p>Are any values still NA?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G_3356_ValueFilled_NA&lt;-<span class="kw">which</span>(<span class="kw">is.na</span>(Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled)<span class="op">==</span><span class="ot">TRUE</span>)
<span class="kw">length</span>(G_3356_ValueFilled_NA) 
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>Linear interpolating the three remaining NAs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G3356_approx&lt;-<span class="kw">approx</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">length</span>(Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled),<span class="dv">1</span>),Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled,
                     <span class="dt">xout=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">length</span>(Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled),<span class="dv">1</span>))
Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled[<span class="kw">which</span>(<span class="kw">is.na</span>(Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled)<span class="op">==</span><span class="ot">TRUE</span>)]&lt;-
<span class="st">  </span>G3356_approx<span class="op">$</span>y[<span class="kw">which</span>(<span class="kw">is.na</span>(Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled)<span class="op">==</span><span class="ot">TRUE</span>)]</code></pre></div>
</div>
<div id="detrending" class="section level3">
<h3>Detrending</h3>
<p>In the analysis completed O-sWL (Ocean-side Water Level) and groundwater level series are subsequently detrended. The Detrend() function uses either a linear fit covering the entire data (Method=<code>linear</code>) or moving averge window (Method=<code>window</code>) of a specified length (<code>Window_Width</code>) to remove trends from a time series. The residuals are added to the final <code>End_Length</code> observations. The default Detrend() parameters specify a moving average (Method=<code>window</code>) three month window (Window_Width=<code>89</code>), to remove any seasonality from the time series. The deafult is then to add the residuals to the average of the final five years of observations (End_Length=<code>1826</code>) to bring the record to the present day level, accounting for the Perigian tide in the case of O-sWL. The mean of the observations over the first three months were subtracted from the values during this period before the present day (5 year) average was added. The following R code detrends the record at Well G_3356. Note the function requires a Date object and the completed series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Cresaring a data from with the imputed series alongside the corresponding dates </span>
G_3356_Imp&lt;-<span class="kw">data.frame</span>(Imp<span class="op">$</span>Data<span class="op">$</span>Date,Imp<span class="op">$</span>Data<span class="op">$</span>ValuesFilled)
<span class="kw">colnames</span>(G_3356_Imp)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;ValuesFilled&quot;</span>)
<span class="co">#Detrending</span>
G_3356_Detrend&lt;-<span class="kw">Detrend</span>(<span class="dt">Data=</span>G_3356_Imp,<span class="dt">PLOT=</span><span class="ot">TRUE</span>,<span class="dt">x_lab=</span><span class="st">&quot;Date&quot;</span>,
                        <span class="dt">y_lab=</span><span class="st">&quot;Groundwater level (ft NGVD 29)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Output of the Detrend_3Month() function is simply the detrended time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(G_3356_Detrend)
<span class="co">#&gt; [1] 2.394700 2.411588 2.360033 2.327588 2.595588 2.520255</span></code></pre></div>
<p>Creating a data frame containing the detrended groundwater series at site S_20 i.e. G_3356_Detrend and their corresponding dates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Groundwater.Detrend.df&lt;-<span class="kw">data.frame</span>(<span class="kw">as.Date</span>(GW_S20<span class="op">$</span>Date),G_3356_Detrend)
<span class="kw">colnames</span>(S20.Groundwater.Detrend.df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Groundwater&quot;</span>)</code></pre></div>
</div>
<div id="declustering" class="section level3">
<h3>Declustering</h3>
<p>The Decluster() function declusters a time series using a threshold u specified as a quantile of the completed series and separation criterion SepCrit to ensure independent events. If mu=365.25 then SepCrit denotes the minimum number of days readings must remain below the threshold before a new event is defined.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G_<span class="fl">3356.</span>Declustered&lt;-<span class="kw">Decluster</span>(<span class="dt">Data=</span>G_3356_Detrend,<span class="dt">u=</span><span class="fl">0.95</span>,<span class="dt">SepCrit=</span><span class="dv">3</span>,<span class="dt">mu=</span><span class="fl">365.25</span>)
<span class="co">#&gt; Warning in x.exceed.max.position[i] &lt;- (x.exceed.lower.bound) +</span>
<span class="co">#&gt; which(Data[(x.exceed.lower.bound + : number of items to replace is not a</span>
<span class="co">#&gt; multiple of replacement length</span></code></pre></div>
<p>Plot showing the completed, detrended record at Well G-3356 (grey circles) along with cluster maxima (red circles) identified using a 95% threshold (green line) and three day separation criterion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G_3356_Imp<span class="op">$</span>Detrend&lt;-G_3356_Detrend
<span class="kw">plot</span>(<span class="kw">as.Date</span>(G_3356_Imp<span class="op">$</span>Date),G_3356_Imp<span class="op">$</span>Detrend,<span class="dt">col=</span><span class="st">&quot;Grey&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,
     <span class="dt">cex=</span><span class="fl">0.25</span>,<span class="dt">xlab=</span><span class="st">&quot;Date&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Groundwater level (ft NGVD 29)&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h=</span>G_<span class="fl">3356.</span>Declustered<span class="op">$</span>Threshold,<span class="dt">col=</span><span class="st">&quot;Dark Green&quot;</span>)
<span class="kw">points</span>(<span class="kw">as.Date</span>(G_3356_Imp<span class="op">$</span>Date[G_<span class="fl">3356.</span>Declustered<span class="op">$</span>EventsMax]),
       G_<span class="fl">3356.</span>Declustered<span class="op">$</span>Declustered[G_<span class="fl">3356.</span>Declustered<span class="op">$</span>EventsMax],<span class="dt">col=</span><span class="st">&quot;Red&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">cex=</span><span class="fl">0.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Other outputs from the Decluster() function include the threshold on the original scale</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G_<span class="fl">3356.</span>Declustered<span class="op">$</span>Threshold
<span class="co">#&gt; [1] 2.751744</span></code></pre></div>
<p>and the number of events per year</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G_<span class="fl">3356.</span>Declustered<span class="op">$</span>EventsPerYear
<span class="co">#&gt; [1] 7.857399</span></code></pre></div>
<p>In preparation for later work, lets assign the detrended and declustered groundwater series at site S20 a name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Groundwater.Detrend.Declustered&lt;-G_<span class="fl">3356.</span>Declustered<span class="op">$</span>Declustered</code></pre></div>
<p>Reading in the other rainfall and O-sWL series at Site S20</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Rainfall.df&lt;-Perrine_df
S20.Rainfall.df<span class="op">$</span>Date&lt;-<span class="kw">as.Date</span>(S20.Rainfall.df<span class="op">$</span>Date)
S20.Rainfall.df<span class="op">$</span>Na.Removed&lt;-S20.Rainfall.df<span class="op">$</span>Value
S20.Rainfall.df<span class="op">$</span>Na.Removed[<span class="kw">which</span>(<span class="kw">is.na</span>(S20.Rainfall.df<span class="op">$</span>Value)<span class="op">==</span><span class="ot">TRUE</span>)]&lt;-<span class="dv">0</span>
S20.OsWL.df&lt;-S20_T_MAX_Daily_Completed_Detrend_Declustered[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]
S20.OsWL.df<span class="op">$</span>Date&lt;-<span class="kw">as.Date</span>(S20.OsWL.df<span class="op">$</span>Date)</code></pre></div>
<p>Detrending and declustering the rainfall and O-sWL series at Site S20</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.OsWL.Detrend&lt;-<span class="kw">Detrend</span>(<span class="dt">Data=</span>S20.OsWL.df,<span class="dt">Method =</span> <span class="st">&quot;window&quot;</span>,<span class="dt">PLOT=</span><span class="ot">FALSE</span>,
                          <span class="dt">x_lab=</span><span class="st">&quot;Date&quot;</span>,<span class="dt">y_lab=</span><span class="st">&quot;O-sWL (ft NGVD 29)&quot;</span>)</code></pre></div>
<p>Creating a dataframe with the date alongside the detrended OsWL series</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.OsWL.Detrend.df&lt;-<span class="kw">data.frame</span>(<span class="kw">as.Date</span>(S20.OsWL.df<span class="op">$</span>Date),S20.OsWL.Detrend)
<span class="kw">colnames</span>(S20.OsWL.Detrend.df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;OsWL&quot;</span>)</code></pre></div>
<p>Declustering rainfall and O-sWL series at site S20,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Setting missing values to zero </span>
S20.Rainfall.Declustered&lt;-<span class="kw">Decluster</span>(<span class="dt">Data=</span>S20.Rainfall.df<span class="op">$</span>Na.Removed,<span class="dt">u=</span><span class="fl">0.95</span>,<span class="dt">SepCrit=</span><span class="dv">3</span>)<span class="op">$</span>Declustered
S20.Rainfall.Declustered[<span class="kw">which</span>(<span class="kw">is.na</span>(S20.Rainfall.df<span class="op">$</span>Value)<span class="op">==</span><span class="ot">TRUE</span>)]&lt;-<span class="ot">NA</span>
<span class="co">#S20.O-sWL does not contain any missing values and so can be declustered without</span>
S20.OsWL.Detrend.Declustered&lt;-<span class="kw">Decluster</span>(<span class="dt">Data=</span>S20.OsWL.Detrend,<span class="dt">u=</span><span class="fl">0.95</span>,<span class="dt">SepCrit=</span><span class="dv">3</span>,<span class="dt">mu=</span><span class="fl">365.25</span>)<span class="op">$</span>Declustered</code></pre></div>
<p>Creating data frames with the date alongside declustered series</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.OsWL.Detrend.Declustered.df&lt;-<span class="kw">data.frame</span>(S20.OsWL.df<span class="op">$</span>Date,S20.OsWL.Detrend.Declustered)
<span class="kw">colnames</span>(S20.OsWL.Detrend.Declustered.df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;OsWL&quot;</span>)
S20.Rainfall.Declustered.df&lt;-<span class="kw">data.frame</span>(S20.Rainfall.df<span class="op">$</span>Date,S20.Rainfall.Declustered)
<span class="kw">colnames</span>(S20.Rainfall.Declustered.df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Rainfall&quot;</span>)
S20.Groundwater.Detrend.Declustered.df&lt;-<span class="kw">data.frame</span>(G_<span class="dv">3356</span><span class="op">$</span>Date,S20.Groundwater.Detrend.Declustered)
<span class="kw">colnames</span>(S20.Groundwater.Detrend.Declustered.df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>,<span class="st">&quot;OsWL&quot;</span>)</code></pre></div>
<p>Use the Dataframe_Combine function to create data frames containing all observations of the original, detrended if necessary, and declustered time series. On dates where not all variables are observed, missing values are assigned NA.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Detrend.df&lt;-<span class="kw">Dataframe_Combine</span>(data.<span class="dv">1</span>&lt;-S20.Rainfall.df,
                                  data.<span class="dv">2</span>&lt;-S20.OsWL.Detrend.df,
                                  data.<span class="dv">3</span>&lt;-S20.Groundwater.Detrend.df,
                                  <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Rainfall&quot;</span>,<span class="st">&quot;OsWL&quot;</span>,<span class="st">&quot;Groundwater&quot;</span>))
S20.Detrend.Declustered.df&lt;-<span class="kw">Dataframe_Combine</span>(data.<span class="dv">1</span>&lt;-S20.Rainfall.Declustered.df,
                                              data.<span class="dv">2</span>&lt;-S20.OsWL.Detrend.Declustered.df,
                                              data.<span class="dv">3</span>&lt;-S20.Groundwater.Detrend.Declustered.df,
                                              <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Rainfall&quot;</span>,<span class="st">&quot;OsWL&quot;</span>,<span class="st">&quot;Groundwater&quot;</span>))</code></pre></div>
<div id="fit-gpd" class="section level4">
<h4>Fit GPD</h4>
<p>The GPD_Fit() function fits a generalized Pareto distribution (GPD) to observations above a threshold u, specified as a quantile of the completed time series. To fit the distribution the GPD_Fit() function requires the declustered series as its Data argument and the entire completed series, detrended if necessary, as its Data.Full argument. The completed series is required to calcuate the value on the original scale corresponding to u. If PLOT==“TRUE” then diagnostic plots are produced to allow an assessment of the fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">GPD_Fit</span>(<span class="dt">Data=</span>S20.Detrend.Declustered.df<span class="op">$</span>Rainfall,<span class="dt">Data_Full=</span><span class="kw">na.omit</span>(S20.Detrend.df<span class="op">$</span>Rainfall),
        <span class="dt">u=</span><span class="fl">0.997</span>,<span class="dt">PLOT=</span><span class="st">&quot;TRUE&quot;</span>,<span class="dt">xlab_hist=</span><span class="st">&quot;O-sWL (ft NGVD 29)&quot;</span>,<span class="dt">y_lab=</span><span class="st">&quot;O-sWL (ft NGVD 29)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; $Threshold
#&gt;  99.7% 
#&gt; 3.5465 
#&gt; 
#&gt; $sigma
#&gt; [1] 1.421037
#&gt; 
#&gt; $xi
#&gt; [1] 0.1696554
#&gt; 
#&gt; $sigma.SE
#&gt; [1] 0.2365755
#&gt; 
#&gt; $xi.SE
#&gt; [1] 0.1781031</code></pre>
</div>
</div>
</div>
<div id="correlation-analysis" class="section level2">
<h2>3. Correlation analysis</h2>
<p>We can use the <code>Kendall_Lag</code> function to view the Kendall’s rank correlations coefficient <span class="math inline">\(\tau\)</span> between the time seres over a range of lags</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Kendall.Results&lt;-<span class="kw">Kendall_Lag</span>(<span class="dt">Data=</span>S20.Detrend.df,<span class="dt">GAP=</span><span class="fl">0.2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Lets pull out the Kendall correlation coefficient values between rainfall and O-sWL for lags of <span class="math inline">\(-5,...,0,..,5\)</span> applied to the latter quantity</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Kendall.Results<span class="op">$</span>Value<span class="op">$</span>Rainfall_OsWL
<span class="co">#&gt;  [1]  0.046483308  0.051860955  0.051392298  0.051311970  0.054097316</span>
<span class="co">#&gt;  [6]  0.058316831  0.061388245  0.035305812  0.004206059 -0.014356749</span>
<span class="co">#&gt; [11] -0.025993095 -0.030431776 -0.029481162</span></code></pre></div>
<p>and the corresponding p-values testing the null hypothesis <span class="math inline">\(\tau =0\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Kendall.Results<span class="op">$</span>Test<span class="op">$</span>Rainfall_OsWL_Test
<span class="co">#&gt;  [1] 5.819748e-13 1.014698e-15 8.196547e-16 1.030482e-15 5.160274e-17</span>
<span class="co">#&gt;  [6] 1.887733e-19 1.987221e-20 2.232548e-07 4.033739e-01 7.669577e-02</span>
<span class="co">#&gt; [11] 1.186248e-03 6.352872e-05 3.864403e-05</span></code></pre></div>
</div>
<div id="bivariate-analysis" class="section level2">
<h2>4. Bivariate Analysis</h2>
<p>In the report the 2D analysis considers the two forcings currently accounted for in structural design assessments undertaken by SFWMD: rainfall and O-sWL. The 2D analysis commences with the well-established two-sided conditional sampling approach, where excesses of a conditioning variable are paired with co-occurring values of another variable to create two samples. For each sample the marginals (one extreme, one non-extreme) and joint distribution are then modeled.</p>
<p>The two (conditional) joint distributions are modeled independently of the marginals by using a copula. The Copula_Threshold_2D() function explores the sensitivity of the best fitting copula, in terms of Akaike Information Criterion (AIC), to allow the practitioner to make an informed choice with regards to threshold selection. It undertakes the conditional sampling described above and reports the best fitting bivariate copula. The procedure is carried out for a single or range of thresholds specified by the <code>Thres</code> argument and the procedure is automatically repeated with the variables switched.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Copula_Threshold_2D</span>(<span class="dt">Data_Detrend=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                    <span class="dt">Data_Declust=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                    <span class="dt">y_lim_min=</span><span class="op">-</span><span class="fl">0.075</span>, <span class="dt">y_lim_max =</span><span class="fl">0.25</span>,
                    <span class="dt">Upper=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">9</span>), <span class="dt">Lower=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">GAP=</span><span class="fl">0.15</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>#&gt; $Kendalls_Tau_Var1
#&gt;  [1] 0.06462446 0.06831834 0.07340181 0.11110660 0.12906919 0.14744597
#&gt;  [7] 0.15130948 0.15369700 0.13101587 0.05056147
#&gt; 
#&gt; $p_value_Var1
#&gt;  [1] 3.953054e-03 4.193644e-03 4.603933e-03 8.693758e-05 1.786936e-05
#&gt;  [6] 6.766536e-06 2.045544e-05 1.347405e-04 7.367252e-03 5.236705e-01
#&gt; 
#&gt; $N_Va1
#&gt;  [1] 893 791 666 565 506 425 360 284 200 107
#&gt; 
#&gt; $Copula_Family_Var1
#&gt;  [1]   6   6   6   6   6   6 104  13   6   6
#&gt; 
#&gt; $Kendalls_Tau_Var2
#&gt;  [1] 0.1113049 0.1359921 0.1377104 0.1561184 0.1579352 0.1359861 0.1183870
#&gt;  [8] 0.1463056 0.1482198 0.1904729
#&gt; 
#&gt; $p_value_Var2
#&gt;  [1] 3.111295e-05 3.130393e-06 1.201990e-05 1.226532e-05 2.030287e-04
#&gt;  [6] 1.218006e-02 4.758068e-02 3.021842e-02 6.691436e-02 7.073874e-02
#&gt; 
#&gt; $N_Var2
#&gt;  [1] 760 639 535 416 290 168 136 110  77  43
#&gt; 
#&gt; $Copula_Family_Var2
#&gt;  [1]   6   6   6   6 204 204 204 204   1 204</code></pre>
<p>The Diag_Non_Con() function is designed to aid in the selection of the appropriate (non-extreme) unbounded marginal distribution for the non-conditioned variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Rainfall&lt;-<span class="kw">Con_Sampling_2D</span>(<span class="dt">Data_Detrend=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                              <span class="dt">Data_Declust=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                              <span class="dt">Con_Variable=</span><span class="st">&quot;Rainfall&quot;</span>,<span class="dt">Thres=</span><span class="fl">0.97</span>)
<span class="kw">Diag_Non_Con</span>(<span class="dt">Data=</span>S20.Rainfall<span class="op">$</span>Data<span class="op">$</span>OsWL,<span class="dt">x_lab=</span><span class="st">&quot;O-sWL (ft NGVD)&quot;</span>,<span class="dt">y_lim_min=</span><span class="dv">0</span>,<span class="dt">y_lim_max=</span><span class="fl">1.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> The Diag_Non_Con_Sel() function, is similar to the Diag_Non_Con() command, but only plots the probability density function and cumulative distribution function of a (single) selected univariate distribution in order to more clearly demonstrate the goodness of fit of a particular distribution. The options are the Gaussian (<code>Gaus</code>) and logistic (<code>Logis</code>) distributions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Diag_Non_Con_Sel</span>(<span class="dt">Data=</span>S20.Rainfall<span class="op">$</span>Data<span class="op">$</span>OsWL,<span class="dt">x_lab=</span><span class="st">&quot;O-sWL (ft NGVD)&quot;</span>,
                 <span class="dt">y_lim_min=</span><span class="dv">0</span>,<span class="dt">y_lim_max=</span><span class="fl">1.5</span>,<span class="dt">Selected=</span><span class="st">&quot;Logis&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> A generalized Pareto distribution is fitted to the marginal distribution of the conditioning variable i.e. the declustered excesses identified using Con_Sampling_2D(). Use <code>GPD_Fit</code> to model the OsWL excesses in the <code>S22.Rainfall$Data</code> sample</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">GPD_Fit</span>(<span class="dt">Data=</span>S20.Rainfall<span class="op">$</span>Data<span class="op">$</span>Rainfall,<span class="dt">Data_Full=</span>S20.Rainfall<span class="op">$</span>Data<span class="op">$</span>Rainfall,<span class="dt">u=</span><span class="dv">0</span>,
        <span class="dt">PLOT=</span><span class="st">&quot;TRUE&quot;</span>,<span class="dt">xlab_hist=</span><span class="st">&quot;Rainfall (Inches)&quot;</span>,<span class="dt">y_lab=</span><span class="st">&quot;Rainfall (Inches)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>#&gt; $Threshold
#&gt;   0% 
#&gt; 1.47 
#&gt; 
#&gt; $sigma
#&gt; [1] 0.8481353
#&gt; 
#&gt; $xi
#&gt; [1] 0.176777
#&gt; 
#&gt; $sigma.SE
#&gt; [1] 0.08700822
#&gt; 
#&gt; $xi.SE
#&gt; [1] 0.06406792</code></pre>
<p>The process of selecting a conditional sample and fitting marginal distributions is repeated but instead conditioning on O-sWL. The non-conditional variable in this case is (total daily) rainfall, which has a lower bound at zero, and thus requires a suitably truncated distribution. The <code>Diag_Non_Con_Trunc</code> fits a selection of truncated distributions to a vector of data. The <code>Diag_Non_Con_Sel_Trunc</code> function is analogous to the ‘Diag_Non_Con_Sel’ function, avalibale distributions are the Birnbaum-Saunders (<code>BS</code>), exponential (<code>Exp</code>), gamma (<code>Gam</code>), inverse Gaussian (<code>InvG</code>), lognormal (<code>LogN</code>), Tweedie (<code>Twe</code>) and Weibull (<code>Weib</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.OsWL&lt;-<span class="kw">Con_Sampling_2D</span>(<span class="dt">Data_Detrend=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                          <span class="dt">Data_Declust=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                          <span class="dt">Con_Variable=</span><span class="st">&quot;OsWL&quot;</span>,<span class="dt">Thres=</span><span class="fl">0.98</span>)
<span class="kw">Diag_Non_Con_Trunc</span>(<span class="dt">Data=</span>S20.OsWL<span class="op">$</span>Data<span class="op">$</span>Rainfall<span class="op">+</span><span class="fl">0.001</span>,<span class="dt">x_lab=</span><span class="st">&quot;Rainfall (Inches)&quot;</span>,
                   <span class="dt">y_lim_min=</span><span class="dv">0</span>,<span class="dt">y_lim_max=</span><span class="dv">2</span>)
<span class="co">#&gt; 1.5 1.7 1.9 2.1 2.3 2.5 </span>
<span class="co">#&gt; ......Done.</span>
<span class="co">#&gt; 1.5 1.7 1.9 2.1 2.3 2.5 </span>
<span class="co">#&gt; ......Done.</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>#&gt; 1.5 1.7 1.9 2.1 2.3 2.5 
#&gt; ......Done.
Diag_Non_Con_Trunc_Sel(Data=S20.OsWL$Data$Rainfall+0.001,x_lab=&quot;Rainfall (Inches)&quot;,
                       y_lim_min=0,y_lim_max=2,
                       Selected=&quot;BS&quot;)
#&gt; 1.5 1.7 1.9 2.1 2.3 2.5 
#&gt; ......Done.</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> Using <code>GPD_Fit</code> to assess the fit of the GPD to the OsWL excesses</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">GPD_Fit</span>(<span class="dt">Data=</span>S20.OsWL<span class="op">$</span>Data<span class="op">$</span>OsWL,<span class="dt">Data_Full=</span>S20.OsWL<span class="op">$</span>Data<span class="op">$</span>OsWL,<span class="dt">u=</span><span class="dv">0</span>,
        <span class="dt">PLOT=</span><span class="st">&quot;TRUE&quot;</span>,<span class="dt">xlab_hist=</span><span class="st">&quot;OsWL (ft NGVD)&quot;</span>,<span class="dt">y_lab=</span><span class="st">&quot;OsWL (ft NGVD)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>#&gt; $Threshold
#&gt;       0% 
#&gt; 1.974928 
#&gt; 
#&gt; $sigma
#&gt; [1] 0.1977586
#&gt; 
#&gt; $xi
#&gt; [1] 0.07922455
#&gt; 
#&gt; $sigma.SE
#&gt; [1] 0.1803204
#&gt; 
#&gt; $xi.SE
#&gt; [1] 0.1381978</code></pre>
<p>The <code>Design_Event_2D()</code> function finds the isoline associated with a particular return period, by overlaying the two corresponding isolines from the joint distributions fitted to the conditional samples using the method in Bender et al. (2016). <code>Design_Event_2D()</code> requires the copulas families chosen to model the dependence structure in the two conditional samples as input.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Copula.Rainfall&lt;-<span class="kw">Copula_Threshold_2D</span>(<span class="dt">Data_Detrend=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                                         <span class="dt">Data_Declust=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                                         <span class="dt">Thres =</span><span class="fl">0.97</span>,<span class="dt">y_lim_min=</span><span class="op">-</span><span class="fl">0.075</span>,<span class="dt">y_lim_max=</span><span class="fl">0.25</span>,
                                         <span class="dt">Upper=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),<span class="dt">Lower=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">GAP=</span><span class="fl">0.15</span>)<span class="op">$</span>Copula_Family_Var1
S20.Copula.OsWL&lt;-<span class="kw">Copula_Threshold_2D</span>(<span class="dt">Data_Detrend=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                                     <span class="dt">Data_Declust=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)],
                                     <span class="dt">Thres =</span><span class="fl">0.97</span>,<span class="dt">y_lim_min=</span><span class="op">-</span><span class="fl">0.075</span>, <span class="dt">y_lim_max =</span><span class="fl">0.25</span>,
                                     <span class="dt">Upper=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">9</span>),<span class="dt">Lower=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">GAP=</span><span class="fl">0.15</span>)<span class="op">$</span>Copula_Family_Var2</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAJACAMAAAAaQUt1AAAA/1BMVEUAAAAAADoAAGYAAP8AOjoAOpAAOv8AZrYAZv8A/wAA/zoA/2YA/5AA/7Y6AAA6ADo6AGY6AP86Ojo6Ov86ZrY6kNs6kP86/wA6/zo6/2Y6/5A6/7Y6/9tmAABmADpmAGZmAP9mkJBmkNtmtrZmtv9m/wBm/zpm/2Zm/5Bm/7Zm//+QOgCQOjqQOmaQOv+QkGaQkNuQkP+Q2/+Q/wCQ/5CQ/7aQ//+2ZgC2Zv+2kGa2kLa2tma22/+2/wC2/zq2/5C2/7a2///bkDrbkP/bttvb29vb/zrb/7bb/9vb////tmb/trb/tv//25D/29v/2////2b//5D//7b//9v///8xx4wrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARoklEQVR4nO2dC3vbthlGlXiJq9T2mnZO0s7uvNXOtmRzN7uLsou3hl6VWbMXW9L//y3DhZRIieBLggDBy3ueJ4kjQYB4jBtB8ONoSQoZhf4CbYeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEcCxp1Bh+C5seH4u+ZyP3xBwfZBcWfoOjJjfzptH52QfEmKFajNNXMLijeBN0dKEEzQyOjINagAubHsvvfXSbddc3sguJF0FI5enQhBjKDHwpqODt/UBDAk6BI9EG6k+Yolkck+p/5seylKSiPxdtD9bcY4ikoj+QEY/LkhoLy0DVIMNmloFwSLWI2lBVUfRUhNN5GMd3IFm9ZgzyXGxoKAvgWxE7ad7mhoSAABQE8CVq81bMdXtXIJ0oWyowrZsMWtDrV4Jp0PqmrYbyqkQdrECI5FWMfZEJf+BmNDPWHgprOzh8UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBuAUPwC14AG6gAnALHoA1CMAteABuwQNwHgSgIIAnQQwsUAwDCxTDwAIABhYAMLAAwmVggfnZWPO5aWVgxf0bkGBxKfI5Kl20xNso5jSwwMOrdyVSzc+AoMXls3fL6Xi/StHdmAc5EvTwUiaY4qqYoluCrkQLeSMqgqgD9+KH5dXex7Pfn8nXZKKX4/GefGs53X949cPLuDFNN1vV/bMytit/UUtBbjrpWNCVOPqpbCV7N6qlLC6P5mfy//qQZQ26F9VjcflGyHqjHcr3Hl6mDV31tgbNX7/TzUTWgavf7t2Il+dnR0nTUYLkH/GyViJEqveVtoT7ar10lwRJ7mV7Ehbmr3/4+oM4btXvxJ2P+kfUMuFFKxMidXuKDeoMKvXR3RIkupPP/yWP9ero4ZuPr98JGVuChLSro/gDUlA8R0gEVaw/XbmqoY9X1QP113Tvn/vLq19evtkWNH/9F9ES14KyPfK0qp+OXNWIj1f2JKrnffhadC3TZ+LVLUGLy1eiC9d90JXsg9JD/3SMppL2XzTomvS6Bol59ZFUISrG/ViYyApSPfNYddsqQTyKLa90PcqOZuXoxlWNdR/07J06WDlUq8NNCxLTJFl5Xqmx7ncv445nuj5Lmer+yPM8aP7thfrXdOjLwFc1Hr65yQxbNbEXZJoCqvcCXtWYymYUTtBkfT5uioQsCXZV4+Hl3s2yHTWooXJD042JYkAsBMFJoNNyQ2MhaFLLTNVyQ2PRB5ni+PspNzQ2ggwPW/FTbmiqC1q83W2y3NBY9EGzkYMq1GNByRyQo5hlwiDZ+YOCADaCRCN7cjOpN9j3WdDs0UX05KbmdKjHguRiT1SwscVxuaGxmyhKQQULZi7LDY19DZoY13qclhsa6z4oqjdd7LMgPVV8VG/ZrNeCGi03NBQE6JGgnZ0d95lWFSSmh208Wd1J4zTnXtSgnU0c5t0HQVt+nBqyESSniOYnqDouF5Ljx6Uhm6saagqtb8XwXy4gV49LRfaL9u04F2uhoGTrRivO5o1+nBmyaGL6LOzuwNwJ6bWimf/AAhkj4/HYgyGbTvruAJyLKUFqZ5DxIppbQeM04QVBmnrefJ6elCIXRfgTdHegBPkMLGDy49RQl2uQ0U9iyEEZfs7FdJLdZcFOB1eCcvUkihyU4e1UQzgS3bh5vt1XQaLhtGcLXpEfZchBGTZNrC2Civ24MlS1iUXrXa6hZ9LtFNSiXa7AjzRUvxA/fdBqoDPXMxd9EPAzHjsow1MfZLzZuXq5BbRRUNk+CO7Tcyho7+NZ5of9+P74MILK9kGGfXoWgQXMaC3ytsz0D/vCzr425KCMTq9Jj+P6Mj9L/fDsnbzp6c19SEEt2UAV+5nu64oT/7B3I2+uP9LS6hfS5Q1USVe8n0T30IL+c7l+rX4h3jdQeYz+ki9Idz/uOqEub6CCghyU0ekNVLCJOSij0xuo8gWlOmkHZfjaQNVIuORcQW0Y5jHNhEvOFdSJiWJTt4XnCpJxBdz58XVdrKFwyeMinJRg1UmrZlPUSTcWWKCVglbX5guG+cYCC3j342t3R2OBBXz78VSDHJYLaKGgEn2Qy3IhXvV4GsVclovx6qfTC2YJPv30QtCGIqc592CX6wrnbhRd3+Xqna7vcvVOx3e5+sfLLleX5YamB/Mgv/RjmPcIBQEoCEBBAAoCUBDAQhDjKIKEjKNYnJBxFEFCxlEECRlHESVkHMXihG0MTeERzoMAFATgehCg+1dWPePp2nwjW/Aawc9VjWa24DWClxrkfAPVibxFt2hWcS7efypLOtlu+LfN9AVV+iDHW/Bud2R273eMw8LtzoskQY6gnJcq4GUUc1yD3n+m/jn/zPD+p+dawbmoQ60QhHG7BS9lRh2s+Ovkz6kmd/1U/xJuP+gE70V7O429Xj99rhrfrXjthfrsiXqzNJ4mik634N3urAytBD1NZZyuWuI9KeZaNLdbqfD8VH1GtdKTz2RvdqHeLE0nZtKfnid99ErQi9Tb6f/I9y7iVid+/vT8Qn3mXCa5FWJk2qRJuv2iOmG4OIpinLpICUof4oagpVQRt7Fr3S1pJfLvJAP3XzT8udh7UYlyBW00sWtR3f7xXLWrD+9fLNeCVh/0K6jEE+pclrtuEaqF5AladdI78g2VXH/m5OLkYtl4DSrxhDrHgQXiGiI73aQLyRxidphXfbOeOp1/JdVl+yDfgso9oc5tYIFbNUlWs0Hp4HxnQ1A8UTzXnZTun9Ur13pkf5EexZqrQYU4DiygTjUu4p9OkyaWnh+lTjVkH3ShptVyDJN9V2YetGxHJ91EYAHIp6/q3AygsRCU9DDtX5O+foHTIOx2uUa7SZQ77+Xa8+n50/oVyPLK6kzeN9+Km1m8Y7dgdvfFB/UH4zGwQDPYLZjJkaycoNrlhsZmG7CoFJNDNjFzwsmuHMnqbYLptaASDPmqRhkGfVWjBEGfN++YygtmZYK8NRZYoAFYgwBduKoRFBtBJYK8NRZYwDs2V1ZbEuStGexONfiUzIKE7Qny1gj2NSh8kLdGsO6DuMPMnJBPyayVMEh2/rDfYdZQuaGx36PYULmhsemkeb9YYULeq1EzYZDs/MFOGsBOGsBOGsBOGsBOGkBBABtBvKGuOCFvqCtO2K5gt96xnwdxydWQkDUIJWQfhBJyFKuVMEh2/qAggNUWvHaGS/aD3UbyZXG4ZH3dfjbQLXgl5kFKkJoGGBePeiyoRLjkhp433wg2+6RhuGQpKL6XY5Bb8Eo8/GjQNQijFx13lwUxBYctaKkciTpmngwMXlDD2fmDggCeBA36Xo3Fv+FC0LDv1Zj/SlaLxV9/Y0w78J32WlDyTx4Dv1dDznJ+9uWXo18Y07IGLf/3009FiY33ajQbWMAFNp30H/Bq66Dv1Vgu/tZgxIfQcKII8C1ogIEF1Bl6VNC9uC03NHZr0ncHu/Lu+SbKDY3dmrSMDsRr84aEUpB89kjhDXWDPlmd7M6P5S2ZBU1s4CercrGwMEjZwE81MAM/WcUMuAbJc6wSG18GHligBMM+WW203NBQEMCiD8LhcVyWGxrWIAAFASgIwD4IwBoEoCCA5YVDNrGChF2JJ+0GmxVFxpMuTFgtnnTtckNjt0+a8aSLEjKeNErIeNK1EgbJzh8UBOC5GMCiBumF+Fm9m1Z7LCi5ZMhRzJCQgQVAwuSqIGO5mhLqJ2NF7IOMCdVQVm+DWb8FNVpuaCgIYLORHO0eK5Omz4ImeHwf9A6zEo9DGPD+oGWpSJzD3mEGH6E69BpkeoRqmkHvMCsVqpQ7zBorNzQUBLA8F0NPhxr0RLHE06EGPVEs8XSoYQ/zJZ4ONfSJInw61LBrUJmnQw37vvkyT4fiRLGxckNDQYCql57/tHph8ccy18WGdt/8eno447X53ITxHFmcSnB/UH5CZSga1QwG3GNBQs53x/Cy4aBPViN81+qgT1ZLxPsf+KkGNjTgk9VyW/AGX4Mgg76qUQqerDZWbmgoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQG8CBr208JLMOynhZeAz3oGDP1p4RDWIACfFo7h08KbKjc0FATwJGjQG8lLMPCN5BBuAwYMeCN5OViDENxIjuBG8sbKDU3DgoYRWKAKXu56VtPQgpseZ48u1EA6O81fsSsRp25FF5uY7vkn5vse42DgVTwY6aCgeClu8dZYhwYuKJla/Vc2Xnll4FC6+E6MmyqM82j06HvVxO4ORDv8qCRtpJLm1p+Y6E/ozLfya8nJ6k4Rm1mn4jjO1OHK53yII5QhrmUc1dlI90HJn61U+o2NT+Tn18GT1fQipZ6yqz75ULU93fwmWUFbqfQbG5/Iza+LpxppQfro4kOWMvSp3ywraCvVqmqlP5GbXxdPVtNNTB9QfMjy38gsKJUqLSjaFpRK2cUatMpS9BddrUF+T1ZTw3yqz9AHpN+LjH3QtqDVJ3SeGym7ebKqrC/eymNajzrxAUXqWkoi6HBzFNsWZBrFPAvym13qsQyreUtyQOt5kJzhbM6DcgTJedDjvydd5VZ+PgWluiIX2fnEHBRy8IJUH1QQd3XwglSjKgjWQkEACgJ0chRrEgoCdFIQl1yL4ZJrMVxyBfRiybVqduMiskl7seTqM7s+LLl6za4PS65es+vDkqvf7Pqw5Oo1u14suXrNjkuuiL4suTaYXV3CLLk2mJ09IZdcG8yuBgGXXBvMzh8UBKAgAAUBKAhAQQAKAlAQgIIAwQR1hkCCqmfs/Jt2pU1QkKOMKcjVF6CgpjMMkl31jCnI1RegoKYzDJJd9YwHK6gvUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIBrQbPRaH27jrytYrdEumhUtNfp7ovVPrrMp8zp1H1V5tsiK+FYkNyYPFvdQfLkRu0tRen0FlaTofnxaqNh5lPmdGqnbGT61VTErSC9IXmym/pPbrSzjXS76/9sMVtHK8p8qiBdvEfauIGzEm4FZb7a3c/NrSGdrlDQbHQ4K3Pg6XTxK+bGWAXHgpST+JvOHv94bOgKMulAE1vv5c1+ypxOM2ljDdK/tfh3F8k6n7kNLD8d6HvXB77xKWO6OE83vbRPQY+Mv/Dsocrf9d2B8XisBM0c9dE+m5juLOJ7VArSoT7Vpom5qj9eO2n9hXO76my64oqxLNVJLzOCImd+fA7z+u7k3F94Jp0+bvNtFat3Cof5dA5RwbSzKj4nivIWOUOgj0y6sn1Q8UQxXdOc1R/3pxqRHpD04DUzz/gz6SaFZwbqwHXCqGi4W6WL9B6yNs6DeggFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIEFxQ8kSu0eMfC2PVb0WyX73gaDOigeCCJHoPUXEwfwqiIDOJoF8fqIcbfPu93P4ZxXti5HZ9Fe1Yv5uN7BulH33ghVYJSh5uIEMmyy2gcieU2n82G52uHmiQjg2dCRrth1YJSh5ucJgE8p09/pDsG0veTUcXzzz6wBOtErSOmx13LEqXNpSNxa7j02cC13uitYLiwf9U37qzGaxeJ4uGLChz1JPN+P+sQdlRPfXqdh8UDVKQPmxRc1T9SD/xIT2KJQ9L8PjdWitIzYNkE5rpHb3rejXAeVCboSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8HwCzkc6nmV+MAAAAASUVORK5CYII=" style="display: block; margin: auto;" /> As input the function requires * Data = Original (detrended) rainfall and O-sWL series * Data_Con1/Data_Con2 = two conditionally sampled datasets, * Thres1/Thres2 = two thresholds associated with the conditionally sampled datasets * Copula_Family1/Copula_Family2 two families of the two fitted copulas * Marginal_Dist1/Marginal_Dist2 Selected non-extreme margnal distributions * HazScen = Hazard scenario (AND/OR) * RP = Return Period of interest * N = size of the sample from the fitted joint distributions used to estimate the density along the isoline of interest * N_Ensemble = size of the ensemble of events sampled along the isoline of interest</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Bivariate&lt;-<span class="kw">Design_Event_2D</span>(<span class="dt">Data=</span>S20.Detrend.df[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], <span class="dt">Data_Con1=</span>S20.Rainfall<span class="op">$</span>Data, 
                               <span class="dt">Data_Con2=</span>S20.OsWL<span class="op">$</span>Data, <span class="dt">Thres1=</span><span class="fl">0.97</span>, <span class="dt">Thres2=</span><span class="fl">0.97</span>, 
                               <span class="dt">Copula_Family1=</span>S20.Copula.Rainfall, <span class="dt">Copula_Family2=</span>S20.Copula.OsWL, 
                               <span class="dt">Marginal_Dist1=</span><span class="st">&quot;Logis&quot;</span>, <span class="dt">Marginal_Dist2=</span><span class="st">&quot;Twe&quot;</span>,
                               <span class="dt">x_lab=</span><span class="st">&quot;Rainfall (mm)&quot;</span>,<span class="dt">y_lab=</span><span class="st">&quot;O-sWL (m NGVD 29)&quot;</span>,
                               <span class="dt">RP=</span><span class="dv">100</span>,<span class="dt">N=</span><span class="dv">10</span>,<span class="dt">N_Ensemble=</span><span class="dv">10</span>)
<span class="co">#&gt; When the response variable contains exact zeros, all values of p must be between 1 and 2; other values have been removed.</span>
<span class="co">#&gt; 1.5 1.7 1.9 </span>
<span class="co">#&gt; ...Done.</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> Design event according to the “Most likely” event approach (diamond in the plot)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Bivariate<span class="op">$</span>MostLikelyEvent
<span class="co">#&gt;   Rainfall     OsWL</span>
<span class="co">#&gt; 1     1.54 3.013893</span></code></pre></div>
<p>Design event under the assuption of full dependence (Triangle in the plot)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Bivariate<span class="op">$</span>FullDependence
<span class="co">#&gt;   Rainfall     OsWL</span>
<span class="co">#&gt; 1    11.64 3.051776</span></code></pre></div>
</div>
<div id="trivariate-analysis" class="section level2">
<h2>5. Trivariate analysis</h2>
<p>In the report three higher dimensional (&gt;3) approaches are implemented to model the joint distribution of rainfall, O-sWL and groundwater level, they are:</p>
<ul>
<li>Standard (trivariate) copula</li>
<li>Pair Copula Construction</li>
<li>Heffernan and Tawn (2004)</li>
</ul>
<p>In the package, each approach has a <code>_Fit</code> and <code>_Sim</code> function. The latter requires a <code>MIGPD</code> object as its <code>Marginals</code> input argument, in order for the simulations on <span class="math inline">\([0,1]3\)</span> to be transformed back to the original scale. The <code>Migpd_Fit</code> command fits independent GPDs to the data in each row of a dataframe (excluding the first column if it is a “Date” object) creating a <code>MIGPD</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Migpd&lt;-<span class="kw">Migpd_Fit</span>(<span class="dt">Data=</span>S20.Detrend.Declustered.df[,<span class="op">-</span><span class="dv">1</span>],<span class="dt">mqu=</span><span class="kw">c</span>(<span class="fl">0.975</span>,<span class="fl">0.975</span>,<span class="fl">0.9676</span>))
<span class="kw">summary</span>(S20.Migpd)
<span class="co">#&gt; $d</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $conv</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $penalty</span>
<span class="co">#&gt; [1] &quot;gaussian&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $co</span>
<span class="co">#&gt;                   Rainfall       OsWL  Groundwater</span>
<span class="co">#&gt; Threshold        1.4200000 1.79170278 2.7067623197</span>
<span class="co">#&gt; P(X &lt; threshold) 0.9750000 0.97500000 0.9676000000</span>
<span class="co">#&gt; sigma            0.8899232 0.05894553 0.2034300877</span>
<span class="co">#&gt; xi               0.1642760 0.62630408 0.0009731279</span>
<span class="co">#&gt; Upper end point        Inf        Inf          Inf</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;class&quot;)</span>
<span class="co">#&gt; [1] &quot;summary.migpd&quot;</span></code></pre></div>
<p>Standard (trivariate) copula are the most conceptually simple of the copula based models, using a single parametric multivariate probability distribution as the copula. The Standard_Copula_Fit() function fits elliptic (specified by <code>Gaussian</code> or <code>tcop</code>) or Archimedean (specified by <code>Gumbel</code>,<code>Clayton</code> or <code>Frank</code>) copula to a trivariate dataset. Let first fit a Gaussian copula</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Gaussian&lt;-<span class="kw">Standard_Copula_Fit</span>(<span class="dt">Data=</span>S20.Detrend.df,<span class="dt">Copula_Type=</span><span class="st">&quot;Gaussian&quot;</span>)</code></pre></div>
<p>From which the Standard_Copula_Sim() function can be used to simulate a synthetic record of N years</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Gaussian.Sim&lt;-<span class="kw">Standard_Copula_Sim</span>(<span class="dt">Data=</span>S20.Detrend.df,<span class="dt">Marginals=</span>S20.Migpd,
                                      <span class="dt">Copula=</span>S20.Gaussian,<span class="dt">N=</span><span class="dv">100</span>)</code></pre></div>
<p>Plotting the observationed and simulated values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Pairs.Plot.Data&lt;-<span class="kw">data.frame</span>(<span class="kw">rbind</span>(<span class="kw">na.omit</span>(S20.Detrend.df[,<span class="op">-</span><span class="dv">1</span>]),S20.Gaussian.Sim<span class="op">$</span>x.Sim),
                                <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Observation&quot;</span>,<span class="kw">nrow</span>(<span class="kw">na.omit</span>(S20.Detrend.df))),
                                  <span class="kw">rep</span>(<span class="st">&quot;Simulation&quot;</span>,<span class="kw">nrow</span>(S20.Gaussian.Sim<span class="op">$</span>x.Sim))))
<span class="kw">colnames</span>(S20.Pairs.Plot.Data)&lt;-<span class="kw">c</span>(<span class="kw">names</span>(S20.Detrend.df)[<span class="op">-</span><span class="dv">1</span>],<span class="st">&quot;Type&quot;</span>)
<span class="kw">pairs</span>(S20.Pairs.Plot.Data[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],
      <span class="dt">col=</span><span class="kw">ifelse</span>(S20.Pairs.Plot.Data<span class="op">$</span>Type<span class="op">==</span><span class="st">&quot;Observation&quot;</span>,<span class="st">&quot;Black&quot;</span>,<span class="kw">alpha</span>(<span class="st">&quot;Red&quot;</span>,<span class="fl">0.3</span>)),
      <span class="dt">upper.panel=</span><span class="ot">NULL</span>,<span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> The Standard_Copula_Sel() function can be used to deduce the best fitting in terms of AIC</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Standard_Copula_Sel</span>(<span class="dt">Data=</span>S20.Detrend.df)
<span class="co">#&gt; Warning in var.mpl(copula, u): the covariance matrix of the parameter</span>
<span class="co">#&gt; estimates is computed as if 'df.fixed = TRUE' with df = 16.1271469165612</span>
<span class="co">#&gt;     Copula        AIC</span>
<span class="co">#&gt; 1 Gaussian -1389.1438</span>
<span class="co">#&gt; 2    t-cop -1434.7850</span>
<span class="co">#&gt; 3   Gumbel  -876.7537</span>
<span class="co">#&gt; 4  Clayton  -565.7595</span>
<span class="co">#&gt; 5    Frank  -854.4284</span></code></pre></div>
<p>Standard trivariate copulas lack flexibility to model joint distributions where heterogeneous dependencies exist between the variable pairs. Pair copula constructions construct multivariate distribution using a cascade of bivariate copulas (some of which are conditional). As the dimensionality of the problem increases the number of mathematically equally valid decompositions quickly becomes large. Bedford and Cooke (2001,2002) introduced the regular vine, a graphical model which helps to organize the possible decompositions. The Canonical (C-) and D- vine are two commonly utilized sub-categories of regular vines, in the trivariate case a vine copula is simultaneously a C- and D-vine. Lets fit a regular vine copula model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Vine&lt;-<span class="kw">Vine_Copula_Fit</span>(<span class="dt">Data=</span>S20.Detrend.df)</code></pre></div>
<p>From which the Vine_Copula_Sim() function can be used to simulate a synthetic record of N years</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Vine.Sim&lt;-<span class="kw">Vine_Copula_Sim</span>(<span class="dt">Data=</span>S20.Detrend.df,<span class="dt">Marginals=</span>S20.Migpd,                              <span class="dt">Vine_family=</span>S20.Vine<span class="op">$</span>Family,<span class="dt">Vine_par=</span>S20.Vine<span class="op">$</span>Par,<span class="dt">Vine_par2=</span>S20.Vine<span class="op">$</span>Par2,<span class="dt">N=</span><span class="dv">100</span>)</code></pre></div>
<p>Plotting the observationed and simulated values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Pairs.Plot.Data&lt;-<span class="kw">data.frame</span>(<span class="kw">rbind</span>(<span class="kw">na.omit</span>(S20.Detrend.df[,<span class="op">-</span><span class="dv">1</span>]),S20.Vine.Sim<span class="op">$</span>x.Sim),
                                <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Observation&quot;</span>,<span class="kw">nrow</span>(<span class="kw">na.omit</span>(S20.Detrend.df))),
                                  <span class="kw">rep</span>(<span class="st">&quot;Simulation&quot;</span>,<span class="kw">nrow</span>(S20.Vine.Sim<span class="op">$</span>x.Sim))))
<span class="kw">colnames</span>(S20.Pairs.Plot.Data)&lt;-<span class="kw">c</span>(<span class="kw">names</span>(S20.Detrend.df)[<span class="op">-</span><span class="dv">1</span>],<span class="st">&quot;Type&quot;</span>)
<span class="kw">pairs</span>(S20.Pairs.Plot.Data[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],
      <span class="dt">col=</span><span class="kw">ifelse</span>(S20.Pairs.Plot.Data<span class="op">$</span>Type<span class="op">==</span><span class="st">&quot;Observation&quot;</span>,<span class="st">&quot;Black&quot;</span>,<span class="kw">alpha</span>(<span class="st">&quot;Red&quot;</span>,<span class="fl">0.3</span>)),
      <span class="dt">upper.panel=</span><span class="ot">NULL</span>,<span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Finally, lets implement the Heffernan and Tawn (2004) approach, where a non-linear regression model is fitted to the (joint) observations where a (conditioning) variable is above a specified threshold. The regression model typically adopted is <span class="math display">\[\textbf{Y}_{-i}=\textbf{a}Y_{i}+Y_{i}^{b}\textbf{Z} \hspace{1cm} for \hspace{1cm} Y_{i}&gt;v\]</span> where <span class="math inline">\(\textbf{Y}\)</span> is a set of variables transdformed to a common scale, <span class="math inline">\(\textbf{Y}_{-i}\)</span> is the set of variables excluding <span class="math inline">\(Y_{-i}\)</span>, <span class="math inline">\(\textbf{a}\)</span> and <span class="math inline">\(\textbf{b}\)</span> are vecotrs of regression parameters and <span class="math inline">\(\textbf{Z}\)</span> is a vecotr of residuals. The dependence structure, when a specified variable is extreme is thus captured by the regression parameters and the joint residuals. The procedure is repeated conditioning on each variable in turn to build up of the joint distribution when at least one variable is in an extreme state. The <code>HT04</code> command fits and simulates N years worth of simulations from the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.HT04&lt;-<span class="kw">HT04</span>(<span class="dt">data_Detrend_Dependence_df=</span>S20.Detrend.df,
               <span class="dt">data_Detrend_Declustered_df=</span>S20.Detrend.Declustered.df,
               <span class="dt">u_Dependence=</span><span class="fl">0.995</span>,<span class="dt">Migpd=</span>S20.Migpd,<span class="dt">mu=</span><span class="fl">365.25</span>,<span class="dt">N=</span><span class="dv">1000</span>)</code></pre></div>
<p>Output of the function includes the three conditional <code>Models</code>, proportion of occasions where each variable is most extreme given at least one variable is extreme <code>prop</code>as well as, the simulations on the transfromed scale <code>u.Sim</code> (gumbel by default) and original scale <code>x.Sim</code>. Lets view the fitted model when conditioning on rainfall</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.HT04<span class="op">$</span>Model<span class="op">$</span>Rainfall
<span class="co">#&gt; mexDependence(x = Migpd, which = colnames(data_Detrend_Dependence_df)[1], </span>
<span class="co">#&gt;     dqu = u_Dependence, margins = Margins, constrain = FALSE, </span>
<span class="co">#&gt;     v = V, maxit = Maxit)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Marginal models:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dependence model:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditioning on Rainfall variable.</span>
<span class="co">#&gt; Thresholding quantiles for transformed data: dqu = 0.995</span>
<span class="co">#&gt; Using gumbel margins for dependence estimation.</span>
<span class="co">#&gt; Log-likelihood = -113.7848 -88.48197 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dependence structure parameter estimates:</span>
<span class="co">#&gt;     OsWL Groundwater</span>
<span class="co">#&gt; a 1.0000      0.4026</span>
<span class="co">#&gt; b 0.6947     -1.1920</span>
S20.HT04<span class="op">$</span>Prop
<span class="co">#&gt; NULL</span></code></pre></div>
<p>and the which the proporiton of the occasions in the original sample that rainfall is the most extreme of the drivers given that at least one driver is extreme.</p>
<p>The HT04 approach uses rejection sampling to generate synthetic records. The first step involves sampling a variable, conditioned to exceed the <code>u_Dependence</code> threshold. A joint residual associated with the corresponding regression is independently sampled and other variables estimated using the fitted regression parameters. If the variable conditioned to be extreme in step one is not the most extreme the sample is rejected. The process is repeated until the relative proportion of simulated events where each variable is a maximum, conditional on being above the threshold, is consistent with the empirical distribution. Labelling the simulations <code>S20.HT04.Sim</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.HT04.Sim&lt;-S20.HT04<span class="op">$</span>x.sim</code></pre></div>
<p>and now plotting the simulations from the HT04 model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S20.Pairs.Plot.Data&lt;-<span class="kw">data.frame</span>(<span class="kw">rbind</span>(<span class="kw">na.omit</span>(S20.Detrend.df[,<span class="op">-</span><span class="dv">1</span>]),S20.HT04.Sim),
                                <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Observation&quot;</span>,<span class="kw">nrow</span>(<span class="kw">na.omit</span>(S20.Detrend.df))),
                                  <span class="kw">rep</span>(<span class="st">&quot;Simulation&quot;</span>,<span class="kw">nrow</span>(S20.HT04.Sim))))
<span class="kw">colnames</span>(S20.Pairs.Plot.Data)&lt;-<span class="kw">c</span>(<span class="kw">names</span>(S20.Detrend.df)[<span class="op">-</span><span class="dv">1</span>],<span class="st">&quot;Type&quot;</span>)
<span class="kw">pairs</span>(S20.Pairs.Plot.Data[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],
      <span class="dt">col=</span><span class="kw">ifelse</span>(S20.Pairs.Plot.Data<span class="op">$</span>Type<span class="op">==</span><span class="st">&quot;Observation&quot;</span>,<span class="st">&quot;Black&quot;</span>,<span class="kw">alpha</span>(<span class="st">&quot;Red&quot;</span>,<span class="fl">0.2</span>)),
      <span class="dt">upper.panel=</span><span class="ot">NULL</span>,<span class="dt">pch=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
